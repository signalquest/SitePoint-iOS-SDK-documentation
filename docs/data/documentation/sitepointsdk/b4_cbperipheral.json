{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B4_CBPeripheral"},"hierarchy":{"paths":[["doc:\/\/SitePointSdk\/documentation\/SitePointSdk"]]},"metadata":{"roleHeading":"Article","modules":[{"name":"SitePointSdk"}],"role":"article","title":"CBPeripheral"},"sections":[],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/sitepointsdk\/b4_cbperipheral"]}],"kind":"article","primaryContentSections":[{"content":[{"text":"Overview","anchor":"Overview","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The CBPeripheral handles reading and writing SignalQuest and RTCM messages with the connected SitePoint."}]},{"anchor":"Reference-the-example-app","type":"heading","level":3,"text":"Reference the example app"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the SitePoint iOS Example App, the "},{"type":"codeVoice","code":"CBPeripheral"},{"type":"text","text":" code is in "},{"type":"codeVoice","code":"SitePoint.swift"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This included SitePointPeripheral class conforms to "},{"code":"CBPeripheralDelegate","type":"codeVoice"},{"text":" to attach to, read, and write Bluetooth characteristics.","type":"text"}]},{"name":"Tip","content":[{"type":"paragraph","inlineContent":[{"text":"SitePointPeripheral uses message handling functions to interface with the SDK, covered later.","type":"text"}]}],"style":"tip","type":"aside"},{"text":"Handle connection initiated by CBCentralManager","level":3,"type":"heading","anchor":"Handle-connection-initiated-by-CBCentralManager"},{"type":"paragraph","inlineContent":[{"text":"In ","type":"text"},{"isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager","type":"reference"},{"type":"text","text":", the connection to a specific SitePoint peripheral was initiated."}]},{"inlineContent":[{"type":"text","text":"The CBCenteralManagerDelegate, on receiving a SitePoint connection, calls SitePointPeripheral’s’ "},{"code":"didConnect","type":"codeVoice"},{"text":" method, allowing it to set itself as the CBPeripheralDelegate for that SitePoint.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func didConnect(_ peripheral: CBPeripheral) {","    self.peripheral = peripheral","    name = peripheral.name","    peripheral.delegate = self","}"],"type":"codeListing"},{"name":"Note","type":"aside","content":[{"inlineContent":[{"type":"text","text":"The SitePoint iOS Example app uses a delegate that conforms to CBPeripheralDelegate to handle callbacks."}],"type":"paragraph"}],"style":"note"},{"type":"paragraph","inlineContent":[{"text":"As noted previosly, the ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager"},{"text":" initiated a ","type":"text"},{"code":"discoverServices","type":"codeVoice"},{"type":"text","text":" call."}]},{"type":"paragraph","inlineContent":[{"text":"Because ","type":"text"},{"type":"codeVoice","code":"self"},{"type":"text","text":" is set as the CBPeripheral’s delegate, the callback for "},{"type":"codeVoice","code":"didDiscoverServices"},{"type":"text","text":" will be called and returns the services discovered."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To discover the characteristics within each service, iterate the services to find the one with "},{"type":"codeVoice","code":"sitePointServiceUuid"},{"type":"text","text":" (00000100-34ed-12ef-63f4-317792041d17), and pass it into a "},{"code":"peripheral.discoverCharacteristics","type":"codeVoice"},{"type":"text","text":" call."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"These characteristics will then be available in the CBPeripheralDelegate’s "},{"type":"codeVoice","code":"didDiscoverCharacteristicsFor"},{"text":" method, and can be bound for future use.","type":"text"}]},{"anchor":"Receiving-SitePoint-location-and-status-data","type":"heading","level":3,"text":"Receiving SitePoint location and status data"},{"type":"paragraph","inlineContent":[{"text":"To receive the SitePoint’s location and status data, parse the incoming messages from the message characteristic. This is handled in the ","type":"text"},{"code":"didUpdateValueFor","type":"codeVoice"},{"text":" callback, which is called when the characteristic has received data.","type":"text"}]},{"inlineContent":[{"text":"The messages are sent to the ","type":"text"},{"type":"codeVoice","code":"MessageHandler"},{"text":" in the SDK, and return structured ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Location"},{"type":"text","text":" and "},{"type":"reference","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Status","isActive":true},{"type":"text","text":" data."}],"type":"paragraph"},{"text":"Sending RTCM messages to the SitePoint","type":"heading","level":3,"anchor":"Sending-RTCM-messages-to-the-SitePoint"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"code":"rtcmCharacteristic","type":"codeVoice"},{"text":" is used to send RTCM messages from an NTRIP service to the SitePoint. This allows the SitePoint to get to near centimeter-level accuracy.","type":"text"}]},{"inlineContent":[{"text":"The next section will cover sending RTCM messages received from an NTRIP service to the SitePoint.","type":"text"}],"type":"paragraph"},{"text":"Read Next","level":2,"type":"heading","anchor":"Read-Next"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP","isActive":true,"type":"reference"}]}]}],"type":"unorderedList"}],"kind":"content"}],"seeAlsoSections":[{"identifiers":["doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B1_Implementation-Guide","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B2_Permissions","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP"],"title":"Implementation","generated":true}],"abstract":[{"type":"text","text":"Set up CBPeripheral to interface with a connected SitePoint Bluetooth device."}],"schemaVersion":{"major":0,"patch":0,"minor":3},"references":{"doc://SitePointSdk/documentation/SitePointSdk/Location":{"navigatorTitle":[{"kind":"identifier","text":"Location"}],"kind":"symbol","title":"Location","abstract":[],"fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"text":"Location","kind":"identifier"}],"url":"\/documentation\/sitepointsdk\/location","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Location","type":"topic","role":"symbol"},"doc://SitePointSdk/documentation/SitePointSdk/Status":{"title":"Status","role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"text":"Status","kind":"identifier"}],"type":"topic","navigatorTitle":[{"kind":"identifier","text":"Status"}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Status","abstract":[],"url":"\/documentation\/sitepointsdk\/status","kind":"symbol"},"doc://SitePointSdk/documentation/SitePointSdk/B3_CBCentralManager":{"abstract":[{"type":"text","text":"Set up "},{"type":"codeVoice","code":"CBCentralManager"},{"type":"text","text":" to scan for and connect to SitePoint Bluetooth devices."}],"type":"topic","url":"\/documentation\/sitepointsdk\/b3_cbcentralmanager","kind":"article","role":"article","title":"CBCentralManager","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager"},"doc://SitePointSdk/documentation/SitePointSdk/B1_Implementation-Guide":{"abstract":[{"type":"text","text":"Review example app code to use the SitePoint SDK with Bluetooth and NTRIP."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B1_Implementation-Guide","kind":"article","title":"Implementation Guide","url":"\/documentation\/sitepointsdk\/b1_implementation-guide","type":"topic","role":"article"},"doc://SitePointSdk/documentation/SitePointSdk/B2_Permissions":{"title":"Permissions","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B2_Permissions","abstract":[{"type":"text","text":"Add permissions for Bluetooth and Location services."}],"kind":"article","role":"article","type":"topic","url":"\/documentation\/sitepointsdk\/b2_permissions"},"doc://SitePointSdk/documentation/SitePointSdk":{"title":"SitePointSdk","url":"\/documentation\/sitepointsdk","abstract":[{"text":"Provides an API and utilities for interfacing with SignalQuest’s SitePoint GNSS devices.","type":"text"}],"kind":"symbol","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk","role":"collection","type":"topic"},"doc://SitePointSdk/documentation/SitePointSdk/B5_NTRIP":{"title":"NTRIP","abstract":[{"text":"Set up NTRIP connection handling and RTCM parsing for aiding the SitePoint.","type":"text"}],"role":"article","identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP","url":"\/documentation\/sitepointsdk\/b5_ntrip","type":"topic","kind":"article"}}}