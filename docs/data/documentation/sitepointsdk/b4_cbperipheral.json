{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The CBPeripheral handles reading and writing SignalQuest and RTCM messages with the connected SitePoint."}]},{"anchor":"Reference-the-example-app","level":3,"type":"heading","text":"Reference the example app"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the SitePoint iOS Example App, the "},{"type":"codeVoice","code":"CBPeripheral"},{"type":"text","text":" code is in "},{"type":"codeVoice","code":"SitePoint.swift"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This included SitePointPeripheral class conforms to "},{"type":"codeVoice","code":"CBPeripheralDelegate"},{"type":"text","text":" to attach to, read, and write Bluetooth characteristics."}]},{"style":"tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"SitePointPeripheral uses message handling functions to interface with the SDK, covered later."}]}],"type":"aside","name":"Tip"},{"anchor":"Handle-connection-initiated-by-CBCentralManager","level":3,"type":"heading","text":"Handle connection initiated by CBCentralManager"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In "},{"type":"reference","isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager"},{"type":"text","text":", the connection to a specific SitePoint peripheral was initiated."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The CBCenteralManagerDelegate, on receiving a SitePoint connection, calls SitePointPeripheral’s’ "},{"type":"codeVoice","code":"didConnect"},{"type":"text","text":" method, allowing it to set itself as the CBPeripheralDelegate for that SitePoint."}]},{"type":"codeListing","syntax":"swift","code":["func didConnect(_ peripheral: CBPeripheral) {","    self.peripheral = peripheral","    name = peripheral.name","    peripheral.delegate = self","}"]},{"style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The SitePoint iOS Example app uses a delegate that conforms to CBPeripheralDelegate to handle callbacks."}]}],"type":"aside","name":"Note"},{"type":"paragraph","inlineContent":[{"type":"text","text":"As noted previosly, the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager"},{"type":"text","text":" initiated a "},{"type":"codeVoice","code":"discoverServices"},{"type":"text","text":" call."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Because "},{"type":"codeVoice","code":"self"},{"type":"text","text":" is set as the CBPeripheral’s delegate, the callback for "},{"type":"codeVoice","code":"didDiscoverServices"},{"type":"text","text":" will be called and returns the services discovered."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To discover the characteristics within each service, iterate the services to find the one with "},{"type":"codeVoice","code":"sitePointServiceUuid"},{"type":"text","text":" (00000100-34ed-12ef-63f4-317792041d17), and pass it into a "},{"type":"codeVoice","code":"peripheral.discoverCharacteristics"},{"type":"text","text":" call."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"These characteristics will then be available in the CBPeripheralDelegate’s "},{"type":"codeVoice","code":"didDiscoverCharacteristicsFor"},{"type":"text","text":" method, and can be bound for future use."}]},{"anchor":"Receiving-SitePoint-location-and-status-data","level":3,"type":"heading","text":"Receiving SitePoint location and status data"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To receive the SitePoint’s location and status data, the incoming messages on the "},{"type":"codeVoice","code":"messageCharacteristic"},{"type":"text","text":" are parsed. This is handled in the "},{"type":"codeVoice","code":"didUpdateValueFor"},{"type":"text","text":" callback, which is called when the characteristic has received data."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The messages are sent to the "},{"type":"codeVoice","code":"MessageHandler"},{"type":"text","text":" in the SDK, and return structured "},{"type":"reference","isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Location"},{"type":"text","text":" and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Status"},{"type":"text","text":" data."}]},{"anchor":"Sending-RTCM-messages-to-the-SitePoint","level":3,"type":"heading","text":"Sending RTCM messages to the SitePoint"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"rtcmCharacteristic"},{"type":"text","text":" is used to send RTCM messages from an NTRIP service to the SitePoint. This allows the SitePoint to get to near centimeter-level accuracy."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The next section will cover sending RTCM messages received from an NTRIP service to the SitePoint."}]},{"anchor":"Read-Next","level":2,"type":"heading","text":"Read Next"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP"}]}]}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/sitepointsdk\/b4_cbperipheral"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B4_CBPeripheral","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Set up CBPeripheral to interface with a connected SitePoint Bluetooth device."}],"kind":"article","metadata":{"roleHeading":"Article","title":"CBPeripheral","role":"article","modules":[{"name":"SitePointSdk"}]},"hierarchy":{"paths":[["doc:\/\/SitePointSdk\/documentation\/SitePointSdk"]]},"seeAlsoSections":[{"title":"Implementation","identifiers":["doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B1_Implementation-Guide","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B2_Permissions","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager","doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP"],"generated":true}],"references":{"doc://SitePointSdk/documentation/SitePointSdk/B3_CBCentralManager":{"role":"article","title":"CBCentralManager","abstract":[{"type":"text","text":"Set up "},{"type":"codeVoice","code":"CBCentralManager"},{"type":"text","text":" to scan for and connect to SitePoint Bluetooth devices."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B3_CBCentralManager","kind":"article","type":"topic","url":"\/documentation\/sitepointsdk\/b3_cbcentralmanager"},"doc://SitePointSdk/documentation/SitePointSdk/B1_Implementation-Guide":{"role":"article","title":"Implementation Guide","abstract":[{"type":"text","text":"Review example app code to use the SitePoint SDK with Bluetooth and NTRIP."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B1_Implementation-Guide","kind":"article","type":"topic","url":"\/documentation\/sitepointsdk\/b1_implementation-guide"},"doc://SitePointSdk/documentation/SitePointSdk/B2_Permissions":{"role":"article","title":"Permissions","abstract":[{"type":"text","text":"Add permissions for Bluetooth and Location services."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B2_Permissions","kind":"article","type":"topic","url":"\/documentation\/sitepointsdk\/b2_permissions"},"doc://SitePointSdk/documentation/SitePointSdk":{"role":"collection","title":"SitePointSdk","abstract":[{"type":"text","text":"Provides an API and utilities for interfacing with SignalQuest’s SitePoint GNSS devices."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk","kind":"symbol","type":"topic","url":"\/documentation\/sitepointsdk"},"doc://SitePointSdk/documentation/SitePointSdk/B5_NTRIP":{"role":"article","title":"NTRIP","abstract":[{"type":"text","text":"Set up NTRIP connection handling and RTCM parsing for aiding the SitePoint."}],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/B5_NTRIP","kind":"article","type":"topic","url":"\/documentation\/sitepointsdk\/b5_ntrip"},"doc://SitePointSdk/documentation/SitePointSdk/Status":{"role":"symbol","title":"Status","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Status"}],"abstract":[],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Status","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Status"}],"url":"\/documentation\/sitepointsdk\/status"},"doc://SitePointSdk/documentation/SitePointSdk/Location":{"role":"symbol","title":"Location","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Location"}],"abstract":[],"identifier":"doc:\/\/SitePointSdk\/documentation\/SitePointSdk\/Location","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Location"}],"url":"\/documentation\/sitepointsdk\/location"}}}